import{c as Ce,j as t,H as Ne,r as ye}from"./app-BBylKGur.js";import{A as we}from"./app-layout-CXZuh_MN.js";import{c as he,B as je}from"./app-logo-icon-BwHC40vT.js";import{d as ae,C as re,a as ce,b as oe,c as de}from"./card-CYO4tml0.js";import{B as r}from"./badge-BeWK984R.js";import{T as Te,C as ke}from"./triangle-alert-DjAxZog_.js";import{A as Se}from"./arrow-left-ByJ9FUzj.js";import{S as Re}from"./shield-check-CIfROCGF.js";/* empty css            */import"./index-B4eBERlR.js";import"./index-XTcFbv2T.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],Le=he("CreditCard",De);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]],Ve=he("Phone",Ae);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],Be=he("SquarePen",$e);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Me=he("User",He),me=(i,e)=>{try{return route(i,e)}catch{return null}},Ie=i=>{if(!i)return null;const e=(i.recent_logs??[]).map(n=>({id:n.id,occurred_at:n.timestamp,license_plate_number:null,has_license_plate:!1,violation_reason:n.direction==="in"?"Sự kiện vào":"Sự kiện ra",image_url:null,result:"violation"}));return{id:i.id,student_code:`ROOM-${i.id}`,full_name:i.name,class_name:i.description??"Không xác định",age:null,gender:null,birth_date:"1970-01-01T00:00:00.000Z",avatar_url:null,contact_phone:null,guardian_name:null,guardian_phone:null,notes:i.description,violation_count:e.length,valid_entries_count:0,cards:(i.persons??[]).map(n=>({id:n.id,card_code:n.counter_track_id,card_type:"RFID",is_active:!0,issued_at:null,expires_at:null})),violations:e,latest_violation:e[0]??null}};function We(i){const e=Ce.c(114);let n;e[0]!==i.room||e[1]!==i.student?(n=i.student??Ie(i.room),e[0]=i.room,e[1]=i.student,e[2]=n):n=e[2];const s=n;let K;e[3]===Symbol.for("react.memo_cache_sentinel")?(K=me("students.index")??me("rooms.index"),e[3]=K):K=e[3];const F=K;let Q;e[4]!==s?(Q=s?me("students.edit",s.id)??me("rooms.edit",s.id):null,e[4]=s,e[5]=Q):Q=e[5];const a=Q;let E;e[6]!==a?(E=()=>{a&&ye.visit(a)},e[6]=a,e[7]=E):E=e[7];const xe=E;let O;e[8]===Symbol.for("react.memo_cache_sentinel")?(O=()=>{F&&ye.visit(F)},e[8]=O):O=e[8];const be=O,ue=qe,fe=Pe;if(!s){let l;e[9]===Symbol.for("react.memo_cache_sentinel")?(l=t.jsx(Ne,{title:"Chi tiết học sinh"}),e[9]=l):l=e[9];let ne;return e[10]===Symbol.for("react.memo_cache_sentinel")?(ne=t.jsxs(we,{children:[l,t.jsxs("div",{className:"flex h-full flex-1 flex-col items-center justify-center gap-4 p-8 text-center",children:[t.jsx(r,{variant:"outline",children:"Dữ liệu chưa sẵn sàng"}),t.jsx("p",{className:"text-muted-foreground",children:"Trang này cần backend mới. Vui lòng thử lại sau khi hệ thống được cập nhật."}),F&&t.jsxs(je,{onClick:be,className:"gap-2",children:[t.jsx(Se,{className:"w-4 h-4"})," Quay lại danh sách"]})]})]}),e[10]=ne):ne=e[10],ne}let U;e[11]!==s.violations?(U=s.violations??[],e[11]=s.violations,e[12]=U):U=e[12];const G=U;let c;e[13]!==s.full_name?(c=t.jsx(Ne,{title:s.full_name}),e[13]=s.full_name,e[14]=c):c=e[14];let X;e[15]===Symbol.for("react.memo_cache_sentinel")?(X=F&&t.jsx(je,{variant:"ghost",size:"icon",onClick:be,children:t.jsx(Se,{className:"w-4 h-4"})}),e[15]=X):X=e[15];let o;e[16]!==s.full_name?(o=t.jsx("h1",{className:"text-3xl font-bold",children:s.full_name}),e[16]=s.full_name,e[17]=o):o=e[17];let d;e[18]!==s.class_name?(d=t.jsx(r,{variant:"secondary",children:s.class_name}),e[18]=s.class_name,e[19]=d):d=e[19];let m;e[20]!==o||e[21]!==d?(m=t.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[o,d]}),e[20]=o,e[21]=d,e[22]=m):m=e[22];const _e=s.age??"—";let h;e[23]!==s.student_code||e[24]!==_e?(h=t.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Mã học sinh: ",s.student_code," • Tuổi: ",_e]}),e[23]=s.student_code,e[24]=_e,e[25]=h):h=e[25];let x;e[26]!==m||e[27]!==h?(x=t.jsxs("div",{className:"flex flex-1 flex-col gap-4 sm:flex-row sm:items-center sm:gap-6",children:[X,t.jsxs("div",{className:"flex flex-col gap-1",children:[m,h]})]}),e[26]=m,e[27]=h,e[28]=x):x=e[28];let u;e[29]!==a||e[30]!==xe?(u=a&&t.jsxs(je,{onClick:xe,className:"gap-2 w-full sm:w-auto",children:[t.jsx(Be,{className:"w-4 h-4"}),"Chỉnh sửa hồ sơ"]}),e[29]=a,e[30]=xe,e[31]=u):u=e[31];let f;e[32]!==x||e[33]!==u?(f=t.jsxs("div",{className:"flex flex-col gap-4 lg:flex-row lg:items-center lg:justify-between",children:[x,u]}),e[32]=x,e[33]=u,e[34]=f):f=e[34];let Z;e[35]===Symbol.for("react.memo_cache_sentinel")?(Z=t.jsxs(re,{children:[t.jsx(ce,{children:"Thông tin tổng quan"}),t.jsx(oe,{children:"Thông tin chi tiết phục vụ kiểm tra vi phạm."})]}),e[35]=Z):Z=e[35];let J;e[36]===Symbol.for("react.memo_cache_sentinel")?(J=t.jsx(Me,{className:"h-5 w-5 text-primary"}),e[36]=J):J=e[36];let _;e[37]!==s.full_name?(_=t.jsx("p",{className:"text-foreground font-medium",children:s.full_name}),e[37]=s.full_name,e[38]=_):_=e[38];let p;e[39]!==s.class_name?(p=t.jsxs("p",{children:["Lớp ",s.class_name]}),e[39]=s.class_name,e[40]=p):p=e[40];let v;e[41]!==s.birth_date?(v=ue(s.birth_date),e[41]=s.birth_date,e[42]=v):v=e[42];let g;e[43]!==v?(g=t.jsxs("p",{children:["Ngày sinh: ",v]}),e[43]=v,e[44]=g):g=e[44];let j;e[45]!==_||e[46]!==p||e[47]!==g?(j=t.jsxs("div",{className:"flex items-center gap-3",children:[J,t.jsxs("div",{children:[_,p,g]})]}),e[45]=_,e[46]=p,e[47]=g,e[48]=j):j=e[48];let W;e[49]===Symbol.for("react.memo_cache_sentinel")?(W=t.jsx(Ve,{className:"h-5 w-5 text-primary"}),e[49]=W):W=e[49];const pe=s.contact_phone??"—";let b;e[50]!==pe?(b=t.jsxs("p",{children:["SĐT học sinh: ",pe]}),e[50]=pe,e[51]=b):b=e[51];const ve=s.guardian_name??"—";let N;e[52]!==ve?(N=t.jsxs("p",{children:["Phụ huynh: ",ve]}),e[52]=ve,e[53]=N):N=e[53];const ge=s.guardian_phone??"—";let y;e[54]!==ge?(y=t.jsxs("p",{children:["SĐT phụ huynh: ",ge]}),e[54]=ge,e[55]=y):y=e[55];let w;e[56]!==b||e[57]!==N||e[58]!==y?(w=t.jsxs("div",{className:"flex items-center gap-3",children:[W,t.jsxs("div",{children:[b,N,y]})]}),e[56]=b,e[57]=N,e[58]=y,e[59]=w):w=e[59];let Y;e[60]===Symbol.for("react.memo_cache_sentinel")?(Y=t.jsx("p",{className:"text-xs font-medium uppercase tracking-wide text-primary",children:"Tình trạng"}),e[60]=Y):Y=e[60];let k;e[61]!==s.valid_entries_count||e[62]!==s.violation_count?(k=t.jsxs("div",{className:"rounded-lg border border-border/50 bg-muted/40 p-3",children:[Y,t.jsxs("p",{className:"mt-1 text-sm",children:["Tổng ",s.violation_count," vi phạm, ",s.valid_entries_count," lượt hợp lệ."]})]}),e[61]=s.valid_entries_count,e[62]=s.violation_count,e[63]=k):k=e[63];let S;e[64]!==s.notes?(S=s.notes&&t.jsxs("div",{className:"rounded-lg border border-dashed border-border/60 bg-muted/30 p-3",children:[t.jsx("p",{className:"text-xs font-medium uppercase tracking-wide text-muted-foreground",children:"Ghi chú nội bộ"}),t.jsx("p",{className:"mt-1 text-sm text-foreground",children:s.notes})]}),e[64]=s.notes,e[65]=S):S=e[65];let C;e[66]!==j||e[67]!==w||e[68]!==k||e[69]!==S?(C=t.jsxs(de,{children:[Z,t.jsxs(ae,{className:"space-y-4 text-sm text-muted-foreground",children:[j,w,k,S]})]}),e[66]=j,e[67]=w,e[68]=k,e[69]=S,e[70]=C):C=e[70];let ee;e[71]===Symbol.for("react.memo_cache_sentinel")?(ee=t.jsxs(re,{className:"flex flex-row items-center justify-between",children:[t.jsxs("div",{children:[t.jsx(ce,{children:"Thẻ đã gắn"}),t.jsx(oe,{children:"Quản lý thẻ RFID/QR của học sinh."})]}),t.jsx(Le,{className:"h-5 w-5 text-primary"})]}),e[71]=ee):ee=e[71];let T;e[72]!==s.cards?(T=s.cards.length===0?t.jsx("p",{className:"text-sm text-muted-foreground",children:"Chưa có thẻ nào. Vui lòng gán thẻ để hệ thống nhận diện."}):s.cards.map(l=>t.jsxs("div",{className:"flex flex-col gap-1 rounded-lg border border-border/60 bg-muted/30 p-3",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-sm font-semibold",children:l.card_code}),t.jsx(r,{variant:l.is_active?"secondary":"outline",size:"sm",children:l.is_active?"Kích hoạt":"Vô hiệu"})]}),t.jsxs("p",{className:"text-xs text-muted-foreground",children:["Loại: ",l.card_type==="RFID"?"RFID":"QR code"]}),t.jsxs("p",{className:"text-xs text-muted-foreground",children:["Cấp ngày: ",ue(l.issued_at)," • Hết hạn: ",ue(l.expires_at)]})]},l.id)),e[72]=s.cards,e[73]=T):T=e[73];let R;e[74]!==T?(R=t.jsxs(de,{children:[ee,t.jsx(ae,{className:"space-y-3",children:T})]}),e[74]=T,e[75]=R):R=e[75];let D;e[76]!==C||e[77]!==R?(D=t.jsxs("div",{className:"grid gap-4 lg:col-span-1",children:[C,R]}),e[76]=C,e[77]=R,e[78]=D):D=e[78];let te;e[79]===Symbol.for("react.memo_cache_sentinel")?(te=t.jsxs("div",{children:[t.jsx(ce,{children:"Vi phạm gần nhất"}),t.jsx(oe,{children:"Dữ liệu ghi nhận từ camera và phân tích AI tại cổng nhà gửi xe."})]}),e[79]=te):te=e[79];let L;e[80]!==s.latest_violation?(L=s.latest_violation&&t.jsxs(r,{variant:"destructive",className:"gap-1",children:[t.jsx(Te,{className:"h-4 w-4"}),fe(s.latest_violation.occurred_at)]}),e[80]=s.latest_violation,e[81]=L):L=e[81];let A;e[82]!==L?(A=t.jsxs(re,{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[te,L]}),e[82]=L,e[83]=A):A=e[83];let V;e[84]!==s.full_name||e[85]!==s.latest_violation?(V=t.jsx(ae,{children:s.latest_violation?t.jsxs("div",{className:"flex flex-col gap-4 lg:flex-row",children:[t.jsx("div",{className:"relative w-full overflow-hidden rounded-xl border bg-muted/40 lg:w-64",children:s.latest_violation.image_url?t.jsx("img",{src:s.latest_violation.image_url,alt:`Ảnh vi phạm của ${s.full_name}`,className:"h-full w-full object-cover"}):t.jsx("div",{className:"flex h-full min-h-[200px] items-center justify-center text-muted-foreground",children:t.jsx(ke,{className:"h-10 w-10"})})}),t.jsxs("div",{className:"flex flex-1 flex-col gap-3 text-sm text-muted-foreground",children:[t.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[t.jsx(r,{variant:"destructive",children:"Vi phạm"}),t.jsxs("span",{children:["Thời gian: ",fe(s.latest_violation.occurred_at)]})]}),t.jsxs("p",{children:["Biển số:"," ",s.latest_violation.has_license_plate?s.latest_violation.license_plate_number??"Không đọc được":"Phương tiện không có biển số"]}),s.latest_violation.violation_reason&&t.jsx("p",{className:"rounded-lg bg-destructive/10 p-3 text-destructive",children:s.latest_violation.violation_reason}),t.jsx("p",{children:"Đề nghị: Nhắc nhở học sinh cung cấp giấy tờ xe hợp lệ hoặc chuyển qua khu vực xe không biển số."})]})]}):t.jsx("div",{className:"rounded-xl border border-dashed border-border/50 p-6 text-center text-sm text-muted-foreground",children:"Chưa ghi nhận vi phạm nào."})}),e[84]=s.full_name,e[85]=s.latest_violation,e[86]=V):V=e[86];let $;e[87]!==A||e[88]!==V?($=t.jsxs(de,{children:[A,V]}),e[87]=A,e[88]=V,e[89]=$):$=e[89];let se;e[90]===Symbol.for("react.memo_cache_sentinel")?(se=t.jsxs("div",{children:[t.jsx(ce,{children:"Lịch sử vi phạm"}),t.jsx(oe,{children:"Tổng hợp 20 lượt mới nhất, bao gồm thông tin biển số và hình ảnh lưu trữ."})]}),e[90]=se):se=e[90];let le;e[91]===Symbol.for("react.memo_cache_sentinel")?(le=t.jsx(Re,{className:"h-4 w-4"}),e[91]=le):le=e[91];let B;e[92]!==s.violation_count?(B=t.jsxs(re,{className:"flex flex-col gap-2 md:flex-row md:items-center md:justify-between",children:[se,t.jsxs(r,{variant:"secondary",className:"gap-1",children:[le,s.violation_count," lượt"]})]}),e[92]=s.violation_count,e[93]=B):B=e[93];let H;e[94]!==s.full_name||e[95]!==G?(H=G.length===0?t.jsx("div",{className:"rounded-xl border border-dashed border-border/50 p-6 text-center text-sm text-muted-foreground",children:"Chưa có dữ liệu vi phạm."}):G.map(l=>t.jsxs("div",{className:"flex flex-col gap-3 rounded-xl border border-border/60 bg-background p-4 shadow-sm transition hover:border-primary/60 hover:shadow-md md:flex-row",children:[t.jsx("div",{className:"relative w-full overflow-hidden rounded-lg border bg-muted/30 md:w-44",children:l.image_url?t.jsx("img",{src:l.image_url,alt:`Minh chứng vi phạm ${s.full_name}`,className:"h-full w-full object-cover"}):t.jsx("div",{className:"flex h-full min-h-[140px] items-center justify-center text-muted-foreground",children:t.jsx(ke,{className:"h-8 w-8"})})}),t.jsxs("div",{className:"flex flex-1 flex-col gap-2 text-sm text-muted-foreground",children:[t.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[t.jsx(r,{variant:l.result==="violation"?"destructive":"secondary",children:l.result==="violation"?"Vi phạm":"Hợp lệ"}),t.jsx("span",{children:fe(l.occurred_at)})]}),t.jsx("p",{children:l.has_license_plate?`Biển số: ${l.license_plate_number??"Không đọc được"}`:"Xe không có biển số"}),l.violation_reason&&t.jsx("p",{className:"rounded-lg bg-destructive/10 p-3 text-destructive",children:l.violation_reason})]})]},l.id)),e[94]=s.full_name,e[95]=G,e[96]=H):H=e[96];let M;e[97]!==H?(M=t.jsx(ae,{className:"space-y-4",children:H}),e[97]=H,e[98]=M):M=e[98];let I;e[99]!==B||e[100]!==M?(I=t.jsxs(de,{children:[B,M]}),e[99]=B,e[100]=M,e[101]=I):I=e[101];let P;e[102]!==$||e[103]!==I?(P=t.jsxs("div",{className:"grid gap-4 lg:col-span-2",children:[$,I]}),e[102]=$,e[103]=I,e[104]=P):P=e[104];let q;e[105]!==D||e[106]!==P?(q=t.jsxs("div",{className:"grid gap-4 lg:grid-cols-3",children:[D,P]}),e[105]=D,e[106]=P,e[107]=q):q=e[107];let z;e[108]!==f||e[109]!==q?(z=t.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4",children:[f,q]}),e[108]=f,e[109]=q,e[110]=z):z=e[110];let ie;return e[111]!==z||e[112]!==c?(ie=t.jsxs(we,{children:[c,z]}),e[111]=z,e[112]=c,e[113]=ie):ie=e[113],ie}function Pe(i){return new Date(i).toLocaleString("vi-VN")}function qe(i){return i?new Date(i).toLocaleDateString("vi-VN"):"Không rõ"}export{We as default};
