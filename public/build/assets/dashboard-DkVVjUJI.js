import{c as Xe,a as Ce,j as t,H as Ye,r as Ge}from"./app-DAsv0CdC.js";import{T as Oe,A as et}from"./app-layout-Btx_wbEe.js";import{c as De,B as Ee}from"./app-logo-icon-BsW23nQ0.js";import{b as x,C as f,a as u,d as p,c as g}from"./card-C_ih7Bid.js";import{B as Qe}from"./badge-DTMq540L.js";import{I as Be}from"./input-aAJ1CvYb.js";import{L as Ke}from"./label-BaCxt1Am.js";import{C as Ze}from"./camera-DLvacw6B.js";/* empty css            */import"./index-DF44pcL7.js";import"./index-9U0-4GU0.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],st=De("ArrowRight",tt);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lt=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],rt=De("ChartPie",lt);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nt=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],it=De("FileDown",nt);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const at=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]],Ue=De("UserCheck",at);function ct(s){const e=Xe.c(9),{className:r}=s,h=Ce.useId();let l;e[0]===Symbol.for("react.memo_cache_sentinel")?(l=t.jsx("path",{d:"M-3 13 15-5M-5 5l18-18M-1 21 17 3"}),e[0]=l):l=e[0];let i;e[1]!==h?(i=t.jsx("defs",{children:t.jsx("pattern",{id:h,x:"0",y:"0",width:"10",height:"10",patternUnits:"userSpaceOnUse",children:l})}),e[1]=h,e[2]=i):i=e[2];const m=`url(#${h})`;let a;e[3]!==m?(a=t.jsx("rect",{stroke:"none",fill:m,width:"100%",height:"100%"}),e[3]=m,e[4]=a):a=e[4];let n;return e[5]!==r||e[6]!==i||e[7]!==a?(n=t.jsxs("svg",{className:r,fill:"none",children:[i,a]}),e[5]=r,e[6]=i,e[7]=a,e[8]=n):n=e[8],n}const dt=[{title:"Dashboard",href:route("dashboard")}];function St(s){const e=Xe.c(117),{stats:r,recentViolations:h,exportDefaults:l}=s;let i;e[0]!==h?(i=h===void 0?[]:h,e[0]=h,e[1]=i):i=e[1];const m=i;let a;e[2]!==m?(a=Array.isArray(m)?m:[],e[2]=m,e[3]=a):a=e[3];const n=a,[c,Re]=Ce.useState(l?.start_date??""),[d,ze]=Ce.useState(l?.end_date??"");let O;e[4]!==l?(O=()=>{l?.start_date&&Re(l.start_date),l?.end_date&&ze(l.end_date)},e[4]=l,e[5]=O):O=e[5];const Te=l?.start_date,Me=l?.end_date;let Q;e[6]!==Te||e[7]!==Me?(Q=[Te,Me],e[6]=Te,e[7]=Me,e[8]=Q):Q=e[8],Ce.useEffect(O,Q);let Ve;e:{if(!c||!d){Ve=!1;break e}let o;e[9]!==c?(o=new Date(c),e[9]=c,e[10]=o):o=e[10];let Se;e[11]!==d?(Se=new Date(d),e[11]=d,e[12]=Se):Se=e[12],Ve=o<=Se}const j=Ve,Je=ft;let Z;e[13]!==d||e[14]!==j||e[15]!==c?(Z=()=>{if(!j)return;const o=route("violations.export",{start_date:c,end_date:d});window.open(o,"_blank","noopener,noreferrer")},e[13]=d,e[14]=j,e[15]=c,e[16]=Z):Z=e[16];const Fe=Z,We=xt,J=mt;let W;e[17]===Symbol.for("react.memo_cache_sentinel")?(W=t.jsx(Ye,{title:"Giám sát vi phạm"}),e[17]=W):W=e[17];let Y;e[18]===Symbol.for("react.memo_cache_sentinel")?(Y=t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Giám sát vi phạm"}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Theo dõi lượt quẹt thẻ, hình ảnh xe và cảnh báo học sinh vi phạm."})]}),e[18]=Y):Y=e[18];let ee;e[19]===Symbol.for("react.memo_cache_sentinel")?(ee=t.jsxs("div",{className:"flex flex-col gap-2 md:flex-row md:items-center md:justify-between",children:[Y,t.jsxs("div",{className:"flex flex-wrap gap-2",children:[t.jsxs(Ee,{onClick:Je,className:"gap-2",children:["Xem danh sách vi phạm",t.jsx(st,{className:"w-4 h-4"})]}),t.jsx(Ee,{variant:"outline",onClick:ht,children:"Thêm học sinh mới"})]})]}),e[19]=ee):ee=e[19];let te;e[20]===Symbol.for("react.memo_cache_sentinel")?(te=t.jsx(x,{children:"Tổng học sinh theo dõi"}),e[20]=te):te=e[20];const Ae=r?.total_students??0;let _;e[21]!==Ae?(_=J(Ae),e[21]=Ae,e[22]=_):_=e[22];let b;e[23]!==_?(b=t.jsxs(f,{children:[te,t.jsx(u,{className:"text-3xl",children:_})]}),e[23]=_,e[24]=b):b=e[24];let se;e[25]===Symbol.for("react.memo_cache_sentinel")?(se=t.jsx(p,{className:"text-sm text-muted-foreground",children:"Số hồ sơ học sinh đang được hệ thống quản lý."}),e[25]=se):se=e[25];let N;e[26]!==b?(N=t.jsxs(g,{children:[b,se]}),e[26]=b,e[27]=N):N=e[27];let le;e[28]===Symbol.for("react.memo_cache_sentinel")?(le=t.jsx(x,{children:"Thẻ đang hoạt động"}),e[28]=le):le=e[28];const He=r?.active_cards??0;let y;e[29]!==He?(y=J(He),e[29]=He,e[30]=y):y=e[30];let v;e[31]!==y?(v=t.jsxs(f,{children:[le,t.jsx(u,{className:"text-3xl",children:y})]}),e[31]=y,e[32]=v):v=e[32];let re;e[33]===Symbol.for("react.memo_cache_sentinel")?(re=t.jsx(p,{className:"text-sm text-muted-foreground",children:"Thẻ RFID/QR hợp lệ để vào nhà gửi xe."}),e[33]=re):re=e[33];let w;e[34]!==v?(w=t.jsxs(g,{children:[v,re]}),e[34]=v,e[35]=w):w=e[35];let ne;e[36]===Symbol.for("react.memo_cache_sentinel")?(ne=t.jsx(x,{children:"Vi phạm trong 7 ngày"}),e[36]=ne):ne=e[36];const Pe=r?.weekly_violations??0;let k;e[37]!==Pe?(k=J(Pe),e[37]=Pe,e[38]=k):k=e[38];let S;e[39]!==k?(S=t.jsxs(f,{children:[ne,t.jsx(u,{className:"text-3xl text-destructive",children:k})]}),e[39]=k,e[40]=S):S=e[40];let ie;e[41]===Symbol.for("react.memo_cache_sentinel")?(ie=t.jsx(p,{className:"text-sm text-muted-foreground",children:"Tổng lượt phát hiện vi phạm gần nhất."}),e[41]=ie):ie=e[41];let C;e[42]!==S?(C=t.jsxs(g,{children:[S,ie]}),e[42]=S,e[43]=C):C=e[43];let ae;e[44]===Symbol.for("react.memo_cache_sentinel")?(ae=t.jsx(x,{children:"Thời gian xử lý trung bình"}),e[44]=ae):ae=e[44];let D;e[45]!==r?(D=r?.average_processing_time!=null&&typeof r.average_processing_time=="number"&&!Number.isNaN(r.average_processing_time)?`${r.average_processing_time.toFixed(1)}s`:"—",e[45]=r,e[46]=D):D=e[46];let T;e[47]!==D?(T=t.jsxs(f,{children:[ae,t.jsx(u,{className:"text-3xl",children:D})]}),e[47]=D,e[48]=T):T=e[48];let ce;e[49]===Symbol.for("react.memo_cache_sentinel")?(ce=t.jsx(p,{className:"text-sm text-muted-foreground",children:"Từ lúc quẹt thẻ đến khi có kết luận."}),e[49]=ce):ce=e[49];let M;e[50]!==T?(M=t.jsxs(g,{children:[T,ce]}),e[50]=T,e[51]=M):M=e[51];let V;e[52]!==N||e[53]!==w||e[54]!==C||e[55]!==M?(V=t.jsxs("div",{className:"grid gap-4 md:grid-cols-2 xl:grid-cols-4",children:[N,w,C,M]}),e[52]=N,e[53]=w,e[54]=C,e[55]=M,e[56]=V):V=e[56];let de;e[57]===Symbol.for("react.memo_cache_sentinel")?(de=t.jsxs("div",{children:[t.jsx(u,{children:"Lượt vi phạm gần đây"}),t.jsx(x,{children:"Tổng hợp 10 lượt mới nhất kèm hình ảnh ghi nhận từ camera."})]}),e[57]=de):de=e[57];let oe;e[58]===Symbol.for("react.memo_cache_sentinel")?(oe=t.jsx(Oe,{className:"w-4 h-4"}),e[58]=oe):oe=e[58];let F;e[59]!==n.length?(F=J(n.length),e[59]=n.length,e[60]=F):F=e[60];let A;e[61]!==F?(A=t.jsxs(f,{className:"flex flex-row items-center justify-between gap-4",children:[de,t.jsxs(Qe,{variant:"secondary",className:"gap-1",children:[oe,F," lượt"]})]}),e[61]=F,e[62]=A):A=e[62];let H;e[63]!==n?(H=n.length===0?t.jsxs("div",{className:"relative overflow-hidden rounded-xl border border-dashed border-sidebar-border/70 p-8 text-center",children:[t.jsx(ct,{className:"absolute inset-0 size-full stroke-neutral-900/20 dark:stroke-neutral-100/20"}),t.jsxs("div",{className:"relative z-10 flex flex-col items-center gap-2",children:[t.jsx(Ue,{className:"w-10 h-10 text-muted-foreground"}),t.jsx("p",{className:"font-medium",children:"Chưa ghi nhận vi phạm nào"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Hệ thống sẽ hiển thị các lượt vi phạm mới nhất tại đây."})]})]}):n.map(ot),e[63]=n,e[64]=H):H=e[64];let P;e[65]!==H?(P=t.jsx(p,{className:"space-y-4",children:H}),e[65]=H,e[66]=P):P=e[66];let I;e[67]!==A||e[68]!==P?(I=t.jsxs(g,{className:"lg:col-span-2",children:[A,P]}),e[67]=A,e[68]=P,e[69]=I):I=e[69];let he;e[70]===Symbol.for("react.memo_cache_sentinel")?(he=t.jsxs(f,{children:[t.jsx(u,{children:"Xuất báo cáo vi phạm"}),t.jsx(x,{children:"Lọc theo khoảng thời gian để tải về file PDF."})]}),e[70]=he):he=e[70];let me;e[71]===Symbol.for("react.memo_cache_sentinel")?(me=t.jsx(Ke,{htmlFor:"export-start",children:"Từ ngày"}),e[71]=me):me=e[71];const Ie=d||void 0;let xe;e[72]===Symbol.for("react.memo_cache_sentinel")?(xe=o=>Re(o.target.value),e[72]=xe):xe=e[72];let L;e[73]!==c||e[74]!==Ie?(L=t.jsxs("div",{className:"grid gap-1.5",children:[me,t.jsx(Be,{id:"export-start",type:"date",value:c,max:Ie,onChange:xe})]}),e[73]=c,e[74]=Ie,e[75]=L):L=e[75];let fe;e[76]===Symbol.for("react.memo_cache_sentinel")?(fe=t.jsx(Ke,{htmlFor:"export-end",children:"Đến ngày"}),e[76]=fe):fe=e[76];const Le=c||void 0;let ue;e[77]===Symbol.for("react.memo_cache_sentinel")?(ue=o=>ze(o.target.value),e[77]=ue):ue=e[77];let $;e[78]!==d||e[79]!==Le?($=t.jsxs("div",{className:"grid gap-1.5",children:[fe,t.jsx(Be,{id:"export-end",type:"date",value:d,min:Le,onChange:ue})]}),e[78]=d,e[79]=Le,e[80]=$):$=e[80];let q;e[81]!==L||e[82]!==$?(q=t.jsxs("div",{className:"grid gap-3",children:[L,$]}),e[81]=L,e[82]=$,e[83]=q):q=e[83];let E;e[84]!==j?(E=!j&&t.jsx("p",{className:"text-xs text-destructive",children:"Vui lòng chọn đầy đủ và đảm bảo ngày bắt đầu không lớn hơn ngày kết thúc."}),e[84]=j,e[85]=E):E=e[85];const $e=!j;let pe;e[86]===Symbol.for("react.memo_cache_sentinel")?(pe=t.jsx(it,{className:"h-4 w-4"}),e[86]=pe):pe=e[86];let R;e[87]!==Fe||e[88]!==$e?(R=t.jsxs(Ee,{type:"button",className:"w-full gap-2",onClick:Fe,disabled:$e,children:[pe,"Xuất PDF"]}),e[87]=Fe,e[88]=$e,e[89]=R):R=e[89];let z;e[90]!==q||e[91]!==E||e[92]!==R?(z=t.jsxs(g,{children:[he,t.jsxs(p,{className:"space-y-4 text-sm",children:[q,E,R]})]}),e[90]=q,e[91]=E,e[92]=R,e[93]=z):z=e[93];let ge;e[94]===Symbol.for("react.memo_cache_sentinel")?(ge=t.jsxs(f,{children:[t.jsx(u,{children:"Đề xuất hành động"}),t.jsx(x,{children:"Hỗ trợ xử lý nhanh các tình huống vi phạm."})]}),e[94]=ge):ge=e[94];let je;e[95]===Symbol.for("react.memo_cache_sentinel")?(je=t.jsxs("div",{className:"rounded-lg border border-border/60 bg-muted/30 p-3",children:[t.jsx("p",{className:"font-medium",children:"Phân loại lại thẻ học sinh"}),t.jsx("p",{className:"text-muted-foreground",children:"Kiểm tra học sinh vi phạm liên tiếp và cập nhật thông tin người giám hộ."})]}),e[95]=je):je=e[95];let _e;e[96]===Symbol.for("react.memo_cache_sentinel")?(_e=t.jsxs("div",{className:"rounded-lg border border-border/60 bg-muted/30 p-3",children:[t.jsx("p",{className:"font-medium",children:"Xuất báo cáo PDF"}),t.jsx("p",{className:"text-muted-foreground",children:"Tổng hợp danh sách vi phạm theo lớp, gửi giáo viên chủ nhiệm mỗi tuần."})]}),e[96]=_e):_e=e[96];let be;e[97]===Symbol.for("react.memo_cache_sentinel")?(be=t.jsxs(g,{children:[ge,t.jsxs(p,{className:"space-y-3 text-sm",children:[je,_e,t.jsxs("div",{className:"rounded-lg border border-border/60 bg-muted/30 p-3",children:[t.jsx("p",{className:"font-medium",children:"Cài đặt cảnh báo"}),t.jsx("p",{className:"text-muted-foreground",children:"Kích hoạt gửi SMS/Email cho phụ huynh khi học sinh tái phạm nhiều lần."})]})]})]}),e[97]=be):be=e[97];let Ne;e[98]===Symbol.for("react.memo_cache_sentinel")?(Ne=t.jsx(u,{children:"Trạng thái hệ thống"}),e[98]=Ne):Ne=e[98];const qe=r?.last_sync_at??null;let B;e[99]!==qe?(B=We(qe),e[99]=qe,e[100]=B):B=e[100];let K;e[101]!==B?(K=t.jsxs(f,{children:[Ne,t.jsxs(x,{children:["Cập nhật lần cuối: ",B]})]}),e[101]=B,e[102]=K):K=e[102];let ye;e[103]===Symbol.for("react.memo_cache_sentinel")?(ye=t.jsxs("div",{className:"flex items-center gap-3 rounded-lg border border-border/60 bg-muted/30 p-3",children:[t.jsx(rt,{className:"h-5 w-5 text-primary"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium",children:"Mô hình AI"}),t.jsx("p",{className:"text-muted-foreground",children:"Độ chính xác mục tiêu ≥ 90% trong điều kiện chuẩn."})]})]}),e[103]=ye):ye=e[103];let ve;e[104]===Symbol.for("react.memo_cache_sentinel")?(ve=t.jsxs("div",{className:"flex items-center gap-3 rounded-lg border border-border/60 bg-muted/30 p-3",children:[t.jsx(Ze,{className:"h-5 w-5 text-primary"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium",children:"Camera nhà gửi xe"}),t.jsx("p",{className:"text-muted-foreground",children:"Hỗ trợ ghi hình Full HD, bù sáng tự động."})]})]}),e[104]=ve):ve=e[104];let we;e[105]===Symbol.for("react.memo_cache_sentinel")?(we=t.jsxs(p,{className:"space-y-3 text-sm",children:[ye,ve,t.jsxs("div",{className:"flex items-center gap-3 rounded-lg border border-border/60 bg-muted/30 p-3",children:[t.jsx(Ue,{className:"h-5 w-5 text-primary"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium",children:"Đầu đọc thẻ"}),t.jsx("p",{className:"text-muted-foreground",children:"Hoạt động ổn định, kiểm thử tính tuổi 0% sai lệch."})]})]})]}),e[105]=we):we=e[105];let U;e[106]!==K?(U=t.jsxs(g,{children:[K,we]}),e[106]=K,e[107]=U):U=e[107];let X;e[108]!==z||e[109]!==U?(X=t.jsxs("div",{className:"grid gap-4",children:[z,be,U]}),e[108]=z,e[109]=U,e[110]=X):X=e[110];let G;e[111]!==I||e[112]!==X?(G=t.jsxs("div",{className:"grid gap-4 lg:grid-cols-3",children:[I,X]}),e[111]=I,e[112]=X,e[113]=G):G=e[113];let ke;return e[114]!==V||e[115]!==G?(ke=t.jsxs(et,{breadcrumbs:dt,children:[W,t.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4",children:[ee,V,G]})]}),e[114]=V,e[115]=G,e[116]=ke):ke=e[116],ke}function ot(s){return t.jsxs("div",{className:"flex flex-col gap-4 rounded-xl border border-border/60 bg-background p-4 shadow-sm transition hover:border-primary/60 hover:shadow-md md:flex-row",children:[t.jsx("div",{className:"relative w-full overflow-hidden rounded-lg border bg-muted/40 md:w-48",children:s.image_url?t.jsx("img",{src:s.image_url,alt:`Ảnh vi phạm của ${s.full_name}`,className:"h-full w-full object-cover"}):t.jsx("div",{className:"flex h-full min-h-[160px] items-center justify-center text-muted-foreground",children:t.jsx(Ze,{className:"h-10 w-10"})})}),t.jsxs("div",{className:"flex flex-1 flex-col gap-3",children:[t.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-2",children:[t.jsxs("div",{children:[t.jsxs("h3",{className:"text-lg font-semibold",children:[s.full_name,t.jsxs("span",{className:"ml-2 text-sm font-normal text-muted-foreground",children:["(",s.class_name,")"]})]}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:["Mã học sinh: ",s.student_code]})]}),t.jsxs(Qe,{variant:"destructive",className:"gap-1",children:[t.jsx(Oe,{className:"h-4 w-4"}),"Vi phạm"]})]}),t.jsxs("div",{className:"grid gap-1 text-sm text-muted-foreground md:grid-cols-2",children:[t.jsxs("span",{children:["Thời gian:"," ",s.occurred_at_display??(s.occurred_at?new Date(s.occurred_at).toLocaleString("vi-VN"):"Không rõ")]}),t.jsx("span",{children:s.has_license_plate?t.jsxs("span",{children:["Biển số: ",s.license_plate_number??"Không xác định"]}):"Phương tiện không có biển số"})]}),s.violation_reason&&t.jsx("p",{className:"rounded-lg bg-destructive/10 p-3 text-sm text-destructive",children:s.violation_reason}),t.jsxs("div",{className:"flex flex-wrap gap-2 text-xs text-muted-foreground",children:[t.jsxs("span",{children:["Tuổi: ",s.age??"—"]}),t.jsxs("span",{children:["Mức độ nguy cơ: ",s.has_license_plate?"Cao":"Trung bình"]})]})]})]},s.id)}function ht(){return Ge.visit(route("students.create"))}function mt(s){return s===null||Number.isNaN(s)?"—":new Intl.NumberFormat("vi-VN").format(s)}function xt(s){return s?new Date(s).toLocaleString("vi-VN",{hour:"2-digit",minute:"2-digit",day:"2-digit",month:"2-digit",year:"numeric"}):"Chưa có dữ liệu"}function ft(){Ge.visit(route("students.index"))}export{St as default};
